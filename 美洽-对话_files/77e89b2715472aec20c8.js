"use strict";(self.webpackChunkmeiqia=self.webpackChunkmeiqia||[]).push([[5821],{414045:(je,St,l)=>{l.d(St,{Zk:()=>v.ZP,Sb:()=>Li,we:()=>Cu,em:()=>yr,ZB:()=>ku,Bc:()=>to,AM:()=>so,nn:()=>Su,cZ:()=>hr,Ll:()=>li,AG:()=>ut,v3:()=>Mu,eF:()=>Zi,h:()=>ai,DM:()=>mu,CW:()=>Zr,qB:()=>Or,r0:()=>_r,PF:()=>dr,EM:()=>fa,VP:()=>ra,SB:()=>qr,sX:()=>Pr,q$:()=>ta,cv:()=>Ur,rg:()=>Nr,zo:()=>aa,Jh:()=>Uu,B0:()=>ea,pR:()=>$u,sq:()=>sr,GU:()=>ia,Sv:()=>Lu,wC:()=>na,Ln:()=>Fr,Ft:()=>Sr,$H:()=>ca,qM:()=>sa,ug:()=>oa,hb:()=>la,_q:()=>Qr,uq:()=>Go});var ut={};l.r(ut),l.d(ut,{convWithStatus:()=>Fi,getAtMeWithoutMineList:()=>Br,getChatConversation:()=>zi,getColleagueList:()=>wr,getColleaguesWithoutAtLit:()=>Lr,getMylist:()=>kr,getRobotPendingConversations:()=>Rr,getSortConvs:()=>Ki,initConvVisitInfo:()=>Ji});var v=l(866681),ct=l(671002),Bt=l(472739),ft=l(14890),Zt=l(297196),p=l(204942),De=l(969826),ke=l(241539),ae=l(821249),X=l(596882),q=l(567178),nt=l(135369),pt,bt=(0,X.Z)({updateAgentListAction:function(t){return t},updateAgentListActionById:function(t){return t},updateAgentGroupsAction:function(t){return t},updateAgentMap:function(t){return t},updataAgentChatUrl:function(t){return t}}),ie=bt.updateAgentListAction,lt=bt.updateAgentListActionById,w=bt.updateAgentGroupsAction,oe=bt.updateAgentMap,Re=bt.updataAgentChatUrl,we=(0,nt.Map)({agentGroupsList:[],agentList:[],agentMap:{},agentChatUrl:""}),vn=(0,q.Z)((pt={},(0,p.Z)(pt,ie,function(e,t){var n=t.payload(e.get("agentList"));return e.set("agentList",n)}),(0,p.Z)(pt,oe,function(e,t){return e.set("agentMap",t.payload)}),(0,p.Z)(pt,lt,function(e,t){var n=t.payload,r=n.id,a=n.func,i=e.get("agentList").find(function(u){return u.id===r}),o=a(i);return e.update("agentList",function(u){return u.map(function(s){return s.id===r?o:s})})}),(0,p.Z)(pt,w,function(e,t){var n=t.payload(e.get("agentGroupsList"));return e.set("agentGroupsList",n)}),(0,p.Z)(pt,Re,function(e,t){var n=t.payload;return e.set("agentChatUrl",n)}),pt),we);const Le=vn;var gn=(0,X.Z)({getQuickReply:function(t){return t}}),Pt=gn.getQuickReply,pn=(0,nt.Map)({myQuickReply:[],enterpriseQuickReply:[]}),Be=(0,q.Z)((0,p.Z)({},Pt,function(e,t){var n=t.payload,r=n.agent_quick_reply_group,a=n.ent_quick_reply_group;return e.set("myQuickReply",r).set("enterpriseQuickReply",a)}),pn);const _n=Be;var R=l(590658),ga=l(447941),mn=l(382526),pa=l(57327),hn=l(438880),_a=l(489554),Cn=l(454747),ma=l(749337),yn=l(833321),ha=l(369070),Mt;function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ue(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Ht=(0,X.Z)({setEnterprise:function(t){return t},updateEnterprise:function(t){return t},updateEnterpriseConfig:function(t){return t}}),xt=Ht.setEnterprise,Wt=Ht.updateEnterprise,jt=Ht.updateEnterpriseConfig,Z=(0,nt.Map)({enterprise:{},enterpriseConfig:{}}),se=(0,q.Z)((Mt={},(0,p.Z)(Mt,xt,function(e,t){return e.set("enterprise",t.payload)}),(0,p.Z)(Mt,Wt,function(e,t){return e.update("enterprise",function(n){return Ut(Ut({},n),t.payload)})}),(0,p.Z)(Mt,jt,function(e,t){return e.update("enterpriseConfig",function(n){return Ut(Ut({},n),t.payload)})}),Mt),Z);const L=se;var rt=l(242982),On=l(226699),Q=l(132023),Ze=l(185827),Ue=l(34553),Ge=l(892222),Ne=l(747042),st=l(545283),z;function Kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Kt(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Ve=500;function ce(e,t){return e.get("visitorList").filter(function(n){return!t.includes(n.track_id)})}var le=function(t,n){return t.reduce(function(r,a){var i=r.findIndex(function(s){return s.id===a.id});if(i>=0){var o=r[i];r[i]=G(G({},a),o)}else{var u=n.find(function(s){return s.track_id===a.track_id&&a.invite_status===void 0});u?r.push(G(G({},a),{},{invite_status:u.invite_status})):r.push(a)}return r},[])},Ft=function(t,n){var r,a=(r=[].concat((0,rt.Z)(t),(0,rt.Z)(n)))!==null&&r!==void 0?r:[];return a.length>Ve?a.slice(-Ve):a};function de(e,t,n){return le(Ft(e,t),n)}function _t(e,t,n){if(!t)return e;var r=e.get("visitorList"),a=r.findIndex(function(i){return i.track_id===t});return a!==-1?e.updateIn(["visitorList",a],function(i){return n(i)}):e}function fe(e,t){var n=t.track_id,r=t.invite_status;if(!n)return e;var a=e.get("visitorList"),i=a.findIndex(function(s){return s.track_id===n});i!==-1&&e.updateIn(["visitorList",i],function(s){return G(G({},s),{},{invite_status:r})});var o=e.get("cacheVisitorInviteStatus"),u=o.findIndex(function(s){return s.track_id===n});return u!==-1?e.updateIn(["cacheVisitorInviteStatus",u],function(s){return G(G({},s),{},{invite_status:r})}):e.set("cacheVisitorInviteStatus",[].concat((0,rt.Z)(o),[t]))}function ve(e,t,n){if(!t)return e;var r=e.get("queueList"),a=r.findIndex(function(i){return i.track_id===t});return a!==-1?e.updateIn(["queueList",a],function(i){return n(i)}):e.set("queueList",[].concat((0,rt.Z)(r),[n({})]))}function $t(e,t,n){var r=e.get("queueList"),a=r.map(function(i){return t.includes(i.track_id)?n(i):i});return e.set("queueList",a)}function ge(e,t){return e.set("queueList",e.get("queueList").filter(function(n){return!t.includes(n.track_id)}))}var pe=(0,nt.Map)({visitorList:[],cacheVisitorInviteStatus:[],queueList:[],queueInline:[],onlineCount:0}),J=(0,X.Z)({GET_VISITOR:function(t){return t},VISITOR_COME:function(t){return t},VISITOR_OFFLINE:function(t){return t},END_CONVERSATION:function(t){return t},INVITE_VISITOR:function(t){return t},REJECT_INVITE:function(t){return t},ACCEPT_INVITE:function(t){return t},INVITE_NO_RESPONSE:function(t){return t},CHANGE_INVITE_STATUS:function(t){return t},UPDATE_VISITOR_STATUS:function(t){return t},GET_QUEUE:function(t){return t},GET_QUEUE_INLINE:function(t){return t},ADD_QUEUE:function(t){return t},REMOVE_QUEUE:function(t){return t},QUEUE_OFFLINE:function(t){return t},QUEUE_ONLINE:function(t){return t}}),Qe=J.getVisitorCondition,zt=J.getVisitor,Jt=J.visitorCome,_e=J.visitorOffline,Xt=J.endConversation,Gt=J.inviteVisitor,mt=J.rejectInvite,Yt=J.acceptInvite,me=J.changeInviteStatus,he=J.updateVisitorStatus,Nt=J.getQueue,qt=J.getQueueInline,Ce=J.addQueue,ye=J.removeQueue,f=J.queueOffline,O=J.queueOnline,m=(0,q.Z)((z={},(0,p.Z)(z,zt,function(e,t){var n,r;return e.merge({visitorList:Ft([],t.payload),onlineCount:(n=(r=t.payload)===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0})}),(0,p.Z)(z,Jt,function(e,t){var n;if(((n=t.payload)===null||n===void 0?void 0:n.length)>0){var r=e.get("onlineCount"),a=e.get("cacheVisitorInviteStatus");return e.merge({visitorList:de(e.get("visitorList"),t.payload,a),onlineCount:r+t.payload.length})}return e}),(0,p.Z)(z,_e,function(e,t){var n;if(((n=t.payload)===null||n===void 0?void 0:n.length)>0){var r=e.get("onlineCount"),a=t.payload.map(function(o){return o.track_id}),i=r-t.payload.length;return e.merge({visitorList:ce(e,a),onlineCount:i>=0?i:0})}return e}),(0,p.Z)(z,Xt,function(e,t){return _t(e,t.payload.track_id,function(n){return G(G({},n),{},{status:st.qH.END_CONVERSE})})}),(0,p.Z)(z,Gt,function(e,t){var n=t.payload.track_id;return _t(e,n,function(r){return G(G({},r),{},{status:st.qH.INVITING})})}),(0,p.Z)(z,mt,function(e,t){var n=t.payload.track_id;return _t(e,n,function(r){return G(G({},r),{},{status:st.qH.REJECT_INVITE})})}),(0,p.Z)(z,Yt,function(e,t){return _t(e,t.payload.track_id,function(n){return G(G({},n),{},{status:st.qH.CONVERSE})})}),(0,p.Z)(z,me,function(e,t){return fe(e,t.payload)}),(0,p.Z)(z,he,function(e,t){return _t(e,t.payload.track_id,function(n){return G(G({},n),{},{status:t.payload.status})})}),(0,p.Z)(z,Nt,function(e,t){var n=t.payload;return e.set("queueList",n)}),(0,p.Z)(z,qt,function(e,t){var n=t.payload;return e.set("queueInline",n)}),(0,p.Z)(z,Ce,function(e,t){var n=t.payload;return ve(e,n.track_id,function(r){return G(G({},n),r)})}),(0,p.Z)(z,ye,function(e,t){var n=t.payload;return ge(e,n)}),(0,p.Z)(z,f,function(e,t){var n;if(((n=t.payload)===null||n===void 0?void 0:n.length)>0){var r=t.payload.map(function(a){return a.track_id});return $t(e,r,function(a){return G({status:"offline"},a)})}return e}),(0,p.Z)(z,O,function(e,t){var n;if(((n=t.payload)===null||n===void 0?void 0:n.length)>0){var r=t.payload.map(function(a){return a.track_id});return $t(e,r,function(a){return G({status:"online"},a)})}return e}),z),pe);const A=m;var P,j=(0,nt.Map)({convTag:[],customerTag:[],callTag:[]}),N=(0,X.Z)({SET_CONV_TAGS:function(t){return t},setCutomerTags:function(t){return t},SET_CALL_TAGS:function(t){return t}}),$=N.setConvTags,it=N.setCutomerTags,ht=N.setCallTags,Ca=(0,q.Z)((P={},(0,p.Z)(P,$,function(e,t){var n=t.payload,r=n.conv_tags,a=r===void 0?[]:r;return e.set("convTag",a)}),(0,p.Z)(P,it,function(e,t){var n=t.payload;return e.set("customerTag",n||[])}),(0,p.Z)(P,ht,function(e,t){var n=t.payload,r=n.call_tags,a=r===void 0?[]:r;return e.set("callTag",a)}),P),j);const ya=Ca;var H;function An(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?An(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):An(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Oa=(0,nt.Map)({callingClient:{address:"",number:""},sipNumber:"",callAgentStatus:0,sipMessage:{message:{},jsep:null},janusErrorMessage:{message:"",code:""},connecting:!1,inCall:!1,allowCall:!0,registerData:{displayName:"",address:"60.205.184.193",port:"5688",server:["wss://ubj.zy-yun.cn:8989","https://ubj.zy-yun.cn:8089/janus"],secret:"mq20201716"},answerType:"web:rtc",mobileNumber:"",summaryConfig:[],softSwitchMessage:{event:"",data:{}},softSwitchApplicationRegistered:!0,jssipMessage:{message:"",data:{}},uuid:"",toolBarShowInfo:{trunkNumber:"",queueName:"",trunkNumberName:""},activeAgentStatus:0,sipRegistered:!0,currentCallInfo:{},fakeRecord:{},selectedClient:{}}),K=(0,X.Z)({updateCallingClientAction:function(t){return t},setSipNumberAction:function(t){return t},updateCallAgentStatusAction:function(t){return t},updateSipMessageAction:function(t){return t},updateConnectingAction:function(t){return t},updateInCallAction:function(t){return t},updateRegisterDataAction:function(t){return t},updateAllowCallAction:function(t){return t},updateJanusErrorMessageAction:function(t){return t},updateSummaryConfigAction:function(t){return t},updateAnswerTypeAction:function(t){return t},updateMobileNumberAction:function(t){return t},updateSoftSwitchMesageAction:function(t){return t},updateSoftSwitchApplicationRegisteredAction:function(t){return t},updateJssipMessageAction:function(t){return t},updateUUidAction:function(t){return t},updateToolBarShowInfoAction:function(t){return t},updateActiveAgentStatusAction:function(t){return t},updateSipRegisteredAction:function(t){return t},updateCurrentCallInfoAction:function(t){return t},updateFakeRecordAction:function(t){return t},updateSelectedClientAction:function(t){return t}}),In=K.updateFakeRecordAction,En=K.updateCallingClientAction,Tn=K.setSipNumberAction,Sn=K.updateCallAgentStatusAction,bn=K.updateSipMessageAction,Pn=K.updateConnectingAction,Mn=K.updateInCallAction,jn=K.updateAllowCallAction,Dn=K.updateRegisterDataAction,kn=K.updateJanusErrorMessageAction,Rn=K.updateSummaryConfigAction,wn=K.updateAnswerTypeAction,Ln=K.updateMobileNumberAction,Bn=K.updateSoftSwitchMesageAction,Zn=K.updateSoftSwitchApplicationRegisteredAction,Un=K.updateJssipMessageAction,Gn=K.updateUUidAction,Nn=K.updateToolBarShowInfoAction,Vn=K.updateActiveAgentStatusAction,Qn=K.updateSipRegisteredAction,Hn=K.updateCurrentCallInfoAction,xn=K.updateSelectedClientAction,Aa=(0,q.Z)((H={},(0,p.Z)(H,En,function(e,t){var n=t.payload.client;return e.set("callingClient",Oe(Oe({},e.get("callingClient")),n))}),(0,p.Z)(H,Tn,function(e,t){var n=t.payload.sipNumber;return e.set("sipNumber",n)}),(0,p.Z)(H,Sn,function(e,t){var n=t.payload.status;return e.set("callAgentStatus",n)}),(0,p.Z)(H,bn,function(e,t){var n=t.payload.message;return e.set("sipMessage",n)}),(0,p.Z)(H,Pn,function(e,t){var n=t.payload.connecting;return e.set("connecting",n)}),(0,p.Z)(H,Mn,function(e,t){var n=t.payload.inCall;return e.set("inCall",n)}),(0,p.Z)(H,Dn,function(e,t){var n=t.payload.data,r=e.get("registerData");return e.set("registerData",Oe(Oe({},r),n))}),(0,p.Z)(H,jn,function(e,t){var n=t.payload.value;return e.set("allowCall",n)}),(0,p.Z)(H,kn,function(e,t){var n=t.payload.obj;return e.set("janusErrorMessage",n)}),(0,p.Z)(H,Rn,function(e,t){var n=t.payload.config;return e.set("summaryConfig",n)}),(0,p.Z)(H,wn,function(e,t){var n=t.payload.type;return e.set("answerType",n)}),(0,p.Z)(H,Ln,function(e,t){var n=t.payload.number;return e.set("mobileNumber",n)}),(0,p.Z)(H,Bn,function(e,t){var n=t.payload.message;return e.set("softSwitchMessage",n)}),(0,p.Z)(H,Zn,function(e,t){var n=t.payload.registered;return e.set("softSwitchApplicationRegistered",n)}),(0,p.Z)(H,Un,function(e,t){var n=t.payload.message;return e.set("jssipMessage",n)}),(0,p.Z)(H,Gn,function(e,t){var n=t.payload.uuid;return e.set("uuid",n)}),(0,p.Z)(H,Nn,function(e,t){var n=t.payload.data;return e.set("toolBarShowInfo",n)}),(0,p.Z)(H,Vn,function(e,t){var n=t.payload.data;return e.set("activeAgentStatus",n)}),(0,p.Z)(H,Qn,function(e,t){var n=t.payload.data;return e.set("sipRegistered",n)}),(0,p.Z)(H,Hn,function(e,t){var n=t.payload.data;return e.set("currentCallInfo",n)}),(0,p.Z)(H,In,function(e,t){var n=t.payload.data;return e.set("fakeRecord",n)}),(0,p.Z)(H,xn,function(e,t){var n=t.payload.data;return e.set("selectedClient",n)}),H),Oa);const Ia=Aa;var Ea=(0,X.Z)({getProductCard:function(t){return t}}),Wn=Ea.getProductCard,Ta=(0,nt.Map)({data:[]}),Sa=(0,q.Z)((0,p.Z)({},Wn,function(e,t){return e.set("data",t.payload.product_cards)}),Ta);const ba=Sa;var Ae,Kn=(0,X.Z)({getIframePlugin:function(t){return t},setIframeEncrypt:function(t){return t}}),Fn=Kn.getIframePlugin,He=Kn.setIframeEncrypt,Pa=(0,nt.Map)({data:[],encryptConfigData:{}}),Ma=(0,q.Z)((Ae={},(0,p.Z)(Ae,Fn,function(e,t){return e.set("data",t.payload.iframes)}),(0,p.Z)(Ae,He,function(e,t){return e.set("encryptConfigData",t.payload.cfg)}),Ae),Pa);const ja=Ma;var us=l(319601),Da={leftConvSetting:{listMode:"normal",sortMode:"new_msg_first",sinkDown:!0,normalListModeSetting:{clentTagShow:!0,timeoutRemind:!1},customListModeSetting:{showType:["mine","sendMsg","coll","mention","queue","visitor"],mineSetting:{mineShowType:"onlineStatus",clentTagShow:!0,timeoutRemind:!1},collSetting:{collShowType:"onlineStatus",clentTagShow:!0}}},rightRelateSetting:{showType:["client","quick","plugin"],qucikShowType:"tab",defaultType:"client"},volumeSetting:{showType:["newMsg","newConv","redirectFrom"],volume:100},notificationSetting:{showType:["newMsg","newConv","redirectFrom","redirectTo"]},foldSetting:[]},ka=(0,X.Z)({mergeConvSetting:function(t){return t}}),xe=ka.mergeConvSetting,Ra=(0,q.Z)((0,p.Z)({},xe,function(e,t){return t.payload?Object.assign({},e,t.payload):e}),Da);const wa=Ra;var te,La=(0,nt.Map)({data:{plan:0},ticket:{},loading:!0}),We=(0,X.Z)({getMarketingStatus:function(t){return t},getTicketStatus:function(t){return t},setLoading:function(t){return t}}),$n=We.getMarketingStatus,zn=We.getTicketStatus,Ke=We.setLoading,Ba=(0,q.Z)((te={},(0,p.Z)(te,$n,function(e,t){return e.set("data",t.payload)}),(0,p.Z)(te,zn,function(e,t){return e.set("ticket",t.payload)}),(0,p.Z)(te,Ke,function(e,t){return e.set("loading",t.payload)}),te),La);const Za=Ba;var Ie;function Jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Xn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Jn(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jn(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Ua={functions:[],functionMap:{},perms:[],permMap:{},permReady:!1,livechatPermMap:{}},Yn=(0,nt.Map)(Ua),Ga=function(t){if(t&&t.data){var n=t.data,r=n.features,a=r===void 0?[]:r,i=n.agent_perms,o=i===void 0?[]:i,u=n.extra_perms,s=u===void 0?[]:u,c=s,g={},d={};return o.forEach(function(y){g[y.key]=y.perms||[],c.push.apply(c,(0,rt.Z)(y.perms))}),c.forEach(function(y){y&&(d[y]=!0)}),{functions:a,perms:c,functionMap:g,permMap:d,permReady:!0}}return Yn},qn=(0,X.Z)({setFunctions:function(t){return t},setLivechatPermMap:function(t){return t}}),tr=qn.setFunctions,er=qn.setLivechatPermMap,Na=(0,q.Z)((Ie={},(0,p.Z)(Ie,tr,function(e,t){var n=t.payload,r=Ga(n);return e.set("functions",r.functions).set("perms",r.perms).set("functionMap",r.functionMap).set("permMap",r.permMap).set("permReady",!0)}),(0,p.Z)(Ie,er,function(e,t){var n=t.payload,r=e.get("livechatPermMap");return e.set("livechatPermMap",Xn(Xn({},r),n))}),Ie),Yn);const Va=Na;var Qa=(0,nt.Map)({channelList:[]}),Ha=(0,X.Z)({setChannelList:function(t){return t}}),nr=Ha.setChannelList,xa=(0,q.Z)((0,p.Z)({},nr,function(e,t){var n=t.payload.data;return e.set("channelList",n)}),Qa);const Wa=xa;var Ka=(0,X.Z)({updateNotificationCount:function(t){return t}}),Fe=Ka.updateNotificationCount,Fa=(0,nt.Map)({count:0}),$a=(0,q.Z)((0,p.Z)({},Fe,function(e,t){var n=t.payload.count;return typeof n=="function"?e.set("count",n(e.get("count"))):e.set("count",n)}),Fa);const za=$a;var Ct=l(496486),Dt=l.n(Ct),ee,Ja=(0,nt.Map)({translateData:[],translateQuota:{}}),$e=(0,X.Z)({addTranslateData:function(t){return t},removeTranslateData:function(t){return t},setTranslateQuota:function(t){return t}}),rr=$e.addTranslateData,ar=$e.removeTranslateData,ir=$e.setTranslateQuota,Xa=function(t,n,r){var a=[],i=n.texts,o=i===void 0?[]:i;return o.length&&o.forEach(function(u){u.target_text&&(t.find(function(s){return s.msg_id===u.msg_id&&s.targetLanguage===u.target_lang})||a.push({msg_id:u.msg_id,track_id:r,translated:u.target_text,targetLanguage:u.target_lang,sourceLanguage:u.source_lang}))}),a},Ya=(0,q.Z)((ee={},(0,p.Z)(ee,rr,function(e,t){var n=t.payload,r=n.translated,a=n.track_id,i=e.get("translateData");return e.set("translateData",[].concat((0,rt.Z)(i),(0,rt.Z)(Xa(i,r,a))))}),(0,p.Z)(ee,ar,function(e,t){var n=t.payload;return e.update("translateData",function(r){return r.length?r.filter(function(a){var i=a.track_id;return i!==n}):r})}),(0,p.Z)(ee,ir,function(e,t){var n=t.payload;return e.set("translateQuota",n)}),ee),Ja);const qa=Ya;var ze=window._mq_main_store;if(!ze){var ti=(0,Bt.U)({agent:Le,quickReply:_n,conversationData:R.ZP,enterprise:L,visitor:A,tag:ya,call:Ia,productCard:ba,iframePlugin:ja,marketingStatus:Za,convSetting:wa,func:Va,channel:Wa,notification:za,translate:qa}),ei=(typeof window=="undefined"||(0,ct.Z)(window),ft.qC),ni=[Zt.Z],ri=ei(ft.md.apply(void 0,ni));ze=window._mq_main_store=(0,ft.MT)(ti,ri)}const ai=ze;var ss=l(788674),cs=l(117727),h=l(667294),E=l(954896),ii=st.pg.TICKET_API_URL,oi=function(){return(0,E.BH)({url:"/plan/marketing/status",method:"get"})},ui=function(){return(0,E.BH)({baseURL:ii,url:"/balance/find_one",method:"get"})};function or(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ur(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?or(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):or(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var si={agent:{},call:{},expire_time:"",has_expired:!0,history_order_cnt:0,mpush_robot:{},package:[],plan:0,plan_name:"",pre_plan:0,pre_plan_name:"",push:{},robot:{},seat:1,seconds_left:0,ticket:{},trial_status:16,overflowed_traffic:1,balance:0},ci=function(){var t=(0,v.I0)(),n=(0,v.v9)(function(u){return u.getIn(["marketingStatus","data"])}),r=(0,v.v9)(function(u){return u.getIn(["marketingStatus","ticket"])}),a=(0,v.v9)(function(u){return u.getIn(["marketingStatus","loading"])}),i=(0,h.useCallback)(function(){t(Ke(!0)),oi().then(function(u){t($n(ur(ur({},si),u.data)))}).finally(function(){t(Ke(!1))})},[]),o=(0,h.useCallback)(function(){ui().then(function(u){var s;t(zn((u==null||(s=u.data)===null||s===void 0?void 0:s.data)||{}))})},[]);return{marketingInfo:n,handleGetMarketingStatus:i,loading:a,ticketInfo:r,handleGetTicketInfo:o}};const sr=ci,li={useMarketingStatus:sr};var Ee=l(115861),di=l(887757),yt=l.n(di),ls=l(891058),ds=l(426833),fs=l(279753),kt=l(131955),F=l(22222),vs=l(583710),fi=function(){return(0,E.BH)({url:"/agent/agents?_".concat(new Date().getTime()),type:"get"})},vi=function(t){var n=t.agentId,r=t.status;return(0,E.BH)({url:"/agent/agents/".concat(n,"/status"),method:"PUT",data:{status:r}})},gi=function(t){return(0,E.BH)({url:"/agent/kick_person_offline",method:"post",data:{agent_id:t}})},cr=(0,E._K)(),pi=cr.isCallAgent,_i=cr.isOnlineAgent,Je=parseInt(kt.Z.get("_agent_id")),lr={},Xe=[],mi=(0,F.P1)([function(e){return e}],function(e){return e.filter(function(t){return t.privilege==="bot"})||Xe}),hi=(0,F.P1)([function(e){return e}],function(e){return e.filter(function(t){return _i(t.serving_types)})||Xe}),Ci=(0,F.P1)([function(e){return e}],function(e){return e.filter(function(t){return pi(t.serving_types)})||Xe}),yi=function(){var t=(0,v.I0)(),n=(0,v.v9)(function(T){return hi(T.getIn(["agent","agentList"]))}),r=(0,v.v9)(function(T){return Ci(T.getIn(["agent","agentList"]))}),a=(0,v.v9)(function(T){return T.getIn(["agent","agentList"])}),i=(0,v.v9)(function(T){return T.getIn(["agent","agentMap"])}),o=a.filter(function(T){return!T.deleted_at}),u=(0,h.useMemo)(function(){return a.find(function(T){return T.id===Je})||lr},[a,Je]),s=(0,h.useMemo)(function(){return a.find(function(T){return T.privilege==="bot"})||lr},[a]),c=(0,v.v9)(function(T){return mi(T.getIn(["agent","agentList"]))}),g=(0,h.useCallback)((0,Ee.Z)(yt().mark(function T(){var D,U,W,I;return yt().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,fi();case 2:D=S.sent,U=D.data,U&&(W=Object.values(U),I=[],W&&Array.isArray(W)&&W.forEach(function(V){var ot=V;ot.id===Je&&(ot.is_online=!0),V.deleted_at&&(ot.email=null),I.push(ot)}),t(oe(U)),t(ie(function(){return I})));case 5:case"end":return S.stop()}},T)})),[]),d=(0,h.useCallback)(function(T){t(ie(T))},[]),y=(0,h.useCallback)(function(T,D){t(lt({id:T,func:D}))},[]),C=(0,h.useCallback)(function(T){var D=T.agentId,U=T.status;return vi({agentId:D,status:U})},[]),M=(0,h.useCallback)(function(T){return gi(T).then(function(){g()})},[g]);return{me:u,robotAgent:s,robotList:c,agentList:n,callAgentList:r,allAgentList:a,ticketAgentList:o,getAgentList:g,updateAgentList:d,updateAgentListById:y,changeAgentStatus:C,handleAgentOffline:M,allAgentMap:i}};const dr=yi;var gs=l(968309),Oi=function(){return(0,E.BH)({url:"/agent/agent_groups"})};function fr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fr(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fr(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Ai=function(){return(0,F.P1)([function(t){return t}],function(t){return t.filter(function(n){return!["__SMARTGUIDE_ROBOTS__","__MPUSH_ROBOTS__","__ROBOTS__ ","__ROBOTS__","__EXTERNAL_ROBOTS__"].includes(n.name)})})},vr=(0,F.P1)([function(e){return e}],function(e){return e.filter(function(t){return!["__SMARTGUIDE_ROBOTS__"].includes(t.name)})}),Ii=(0,F.P1)([function(e){return e}],function(e){return e.filter(function(t){return!["__SMARTGUIDE_ROBOTS__","__MPUSH_ROBOTS__","__ROBOTS__ ","__ROBOTS__"].includes(t.name)})}),gr={__MPUSH_ROBOTS__:"\u8425\u9500\u673A\u5668\u4EBA\u7EC4","__ROBOTS__ ":"\u673A\u5668\u4EBA",__ROBOTS__:"\u673A\u5668\u4EBA",__SMARTGUIDE_ROBOTS__:"\u667A\u80FD\u5F15\u5BFC\u673A\u5668\u4EBA\u7EC4",__EXTERNAL_ROBOTS__:"\u5916\u90E8\u673A\u5668\u4EBA"};function pr(e){return Te(Te({},e),{},{name:gr[e.name]||e.name,prevName:e.name})}var Ei=(0,F.P1)([function(e){return e}],function(e){return e.map(function(t){return Te(Te({},t),{},{name:gr[t.name]||t.name,prevName:t.name})})}),Ti=Ai(),Si=function(){var t=(0,v.v9)(function(u){return u.getIn(["agent","agentGroupsList"])}),n=Ti(t),r=Ii(t).map(pr),a=vr(t).map(pr),i=(0,v.I0)(),o=(0,h.useCallback)((0,Ee.Z)(yt().mark(function u(){var s,c,g,d;return yt().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,Oi();case 2:s=C.sent,c=s.data,c&&(g=c.agent_groups,d=g===void 0?[]:g,i(w(function(){return d})));case 5:case"end":return C.stop()}},u)})),[]);return{agentGroupAll:Ei(t),agentGroupList:n,getAgentGroupList:o,agentGroupWithExBotList:r,agentGroupWithoutSmartGuideList:a,withoutSmartGuideGroup:vr}};const _r=Si;var ps=l(126541),mr=function(t,n){var r=n.privilege_range,a=n.id,i=!1;return r==="self"?i=a!==t.id:r==="all"?i=!1:(i=!0,Array.isArray(r)&&r.forEach(function(o){o===t.group_id&&(i=!1)}),a===t.id&&(i=!1)),!i},bi=function(t,n,r){var a={bot:function(){return(0,E.Q0)(t.privilege)},notBot:function(){return!(0,E.Q0)(t.privilege)},notSmartGuideBot:function(){return t.privilege!=="bot:smartguide"},notMarketingBot:function(){return t.privilege!=="bot:mpush"},withSip:function(){return!!t.sip_id},withoutSip:function(){return!t.sip_id},deleted:function(){return!t.email||t.deleted_at},notDeleted:function(){return t.email&&!t.deleted_at},onLine:function(){return t.is_online},onLineOrBot:function(){return t.is_online||t.privilege==="bot"},notMe:function(){var o=n.id;return o!==t.id},onlyWithExBot:function(){return t.privilege!=="bot"&&t.privilege!=="bot:smartguide"&&t.privilege!=="bot:mpush"},inPerm:function(o){return mr(o,n)},inOthersPerm:function(o){return mr(n,o)}};return r.every(function(i){return a[i](t)})},et=function(t,n,r){return t.filter(function(a){return bi(a,n,r)})},Pi=function(){return(0,F.P1)([function(t){return t},function(t,n){return n},function(t,n,r){return r}],function(t,n,r){var a=[];switch(n){case"active":a=t.filter(function(i){return i.is_online});break;case"offline":a=t.filter(function(i){return!i.is_online&&i.status==="off_duty"});break;case"online":a=t.filter(function(i){return!i.is_online&&i.status!=="off_duty"});break;case"withSipAndEffective":a=et(t,r,["withSip","notDeleted","notBot"]);break;case"withoutSipAndEffective":a=et(t,r,["withoutSip","notDeleted","notBot"]);break;case"mention":a=et(t,r,["onLine","notMe","notDeleted","notBot"]),a=(0,Ct.sortBy)(a,function(i){return i.status==="off_duty"});break;case"ticketAgent":a=et(t,r,["notDeleted"]);break;case"redirect":a=et(t,r,["onLine","notDeleted","notBot"]);break;case"filter":a=et(t,r,["inPerm","onLine","notDeleted","notMe","notSmartGuideBot"]);break;case"perm":a=et(t,r,["inPerm"]);break;case"permNotDeleted":a=et(t,r,["inPerm","notDeleted"]);break;case"notDeleteWithoutRobot":a=et(t,r,["notDeleted","notBot"]);break;case"agentWithGroup":a=et(t,r,["inPerm","notDeleted","notBot"]);break;case"notDeleteOrRobot":a=et(t,r,["notDeleted","notBot"]);break;case"inspectionFilter":a=et(t,r,["inPerm","notDeleted"]);break;case"homeTable":a=et(t,r,["inPerm","notDeleted"]);break;case"smartGuide":a=et(t,r,["notDeleted","notBot"]);break;case"notBot":a=et(t,r,["notBot"]);break;case"notDeleteWithExRobot":a=et(t,r,["notDeleted","onlyWithExBot"]);break;default:a=[]}return a})};const hr=Pi;function Cr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ot(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Cr(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cr(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Mi=function(t){return["bot","bot:smartguide"].includes(t)},ji=(0,F.P1)([function(e){return e},function(e,t){return t}],function(e,t){var n=e.map(function(r){return Ot(Ot({},r),{},{label:r.realname||r.nickname,value:r.token})});return t.map(function(r){var a=n.filter(function(i){return i.group_id===r.id});return a&&a.length>0?Ot(Ot({},r),{},{label:r.name,value:r.token,children:a}):null}).filter(function(r){return r})}),Di=(0,F.P1)([function(e){return e},function(e,t){return t}],function(e,t){var n=e.map(function(r){return Ot(Ot({},r),{},{label:r.realname,value:r.id})});return t.map(function(r){var a=n.filter(function(i){return i.group_id===r.id});return a&&a.length>0?Ot(Ot({},r),{},{label:r.name,value:r.id,children:a}):null}).filter(function(r){return r})}),ki={withRobotGroup:!0,withEmptyGroup:!1},Ri=(0,F.P1)([function(e){return e},function(e,t){return t},function(e,t,n){return n||ki}],function(e,t,n){var r=n.withRobotGroup,a=r===void 0?!0:r,i=n.withEmptyGroup,o=i===void 0?!1:i,u=n.withAvatar,s=u===void 0?!1:u,c=e.filter(function(d){return!Mi(d.privilege)}),g=[];return t.forEach(function(d){var y=d.id,C=d.name,M=d.prevName,T=a?e:c,D=T.filter(function(I){return I.group_id===y});if(D.length){var U=["__ROBOTS__","__ROBOTS__ "].includes(M),W={title:C,label:C,value:U?"group_bot":y,key:U?"group_bot":y,children:D.map(function(I){var B={label:I.realname||I.nickname,title:I.realname||I.nickname,key:I.id,value:I.id,id:y};return s&&(B.avatar=I.avatar),B})};U?W.group_id="group_bot":W.id=y,g.push(W)}else o&&g.push({title:C,label:C,value:y,key:y,id:y,children:[]})}),g});const yr={combSelectAgentGroupToken:ji,combTreeAgentGroup:Ri,combSelectAgentGroupId:Di};var At=l(778001),wi=function(){var t=(0,v.I0)(),n=(0,v.v9)(function(a){return a.getIn(["agent","agentChatUrl"])})||At.Z.t("\u4F01\u4E1A\u804A\u5929\u94FE\u63A5"),r=function(i){t(Re(i))};return{agentChatUrl:n,updataAgentChatUrl:r}};const Or=wi,Li={useAgents:dr,useAgentGroups:_r,makeFilterAgent:hr,combAgentGroup:yr,useAgentChatUrl:Or};var Ar=function(){return(0,E.BH)({url:"/agent/quick_replies",method:"get"})},_s=l(702707),Ir=function(){return(0,F.P1)([function(t){return t}],function(t){return!t||t.length===0?[]:(t=t.sort(function(n,r){return n.rank-r.rank}),t.map(function(n){var r=n.quick_replies;return r&&r.length&&(n.quick_replies=r.sort(function(a,i){return a.rank-i.rank})),n}))})},Er=Ir(),Tr=Ir(),Bi=function(){var t=(0,v.v9)(function(o){return o.getIn(["quickReply","myQuickReply"])}),n=(0,v.v9)(function(o){return o.getIn(["quickReply","enterpriseQuickReply"])}),r=(0,v.I0)(),a=(0,h.useCallback)(function(o){var u=o.type,s=o.data;switch(u){case"my":r(Pt({agent_quick_reply_group:s,ent_quick_reply_group:n}));break;case"enterprise":r(Pt({agent_quick_reply_group:t,ent_quick_reply_group:s}));break;default:break}},[t,n]),i=(0,h.useCallback)(function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(o){if(!(n!=null&&n.length)&&!(t!=null&&t.length))return Ar().then(function(u){if(u&&u.data){var s=u.data,c=s.agent_quick_reply_group,g=s.ent_quick_reply_group;r(Pt({agent_quick_reply_group:Er(c),ent_quick_reply_group:Tr(g)}))}})}else return Ar().then(function(u){if(u&&u.data){var s=u.data,c=s.agent_quick_reply_group,g=s.ent_quick_reply_group;r(Pt({agent_quick_reply_group:Er(c),ent_quick_reply_group:Tr(g)}))}})},[t,n]);return{myQuickReply:t,enterpriseQuickReply:n,handleGetReply:i,handleUpdateReply:a}};const Sr=Bi,Zi={useQuickReply:Sr};var ms=l(974916),hs=l(864765),Cs=l(932564),Ui=l(436762),Gi=function(){return new Promise(function(t,n){(0,E.BH)({url:"/conversation/agent/active",method:"get"}).then(function(r){var a=r.data,i=a.conversations;t({data:i})}).catch(function(r){n(r)})})},ys=function(t){var n=t.agent_id;return fetch({url:"/conversation/agent/trusteeship",method:"get",params:{agent_id:n}})},Ye=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cursor:-1,limit:15},n=t.cursor,r=t.limit,a=t.entId,i={cursor:n,limit:r,ent_id:a},o=(0,Ui.b1)();return o!=null&&o.length&&(i.agent_ids=o),new Promise(function(u,s){(0,E.BH)({url:"/conversation/agent/colleagues/v2",method:"post",data:i}).then(function(c){var g=c.data,d=g.conversations,y=g.has_next,C=g.next_cursor;u({data:d,hasNext:y,nextCursor:C})}).catch(function(c){s(c)})})},Ni=function(t){return new Promise(function(n,r){(0,E.BH)({url:"/agent/agents/".concat(t,"/mentioned_convs"),method:"get"}).then(function(a){var i=a.data;n({data:i.convs})}).catch(function(a){r(a)})})};function br(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?br(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):br(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var qe=window.parseInt(kt.Z.get("_enterprise_id")),Vi={},Qi=E.en.parseQueryStringObj,tn=function(t,n){var r=window.location.pathname,a=window.location.search;if(r==="/chat"){var i=Qi(a),o=i.id,u=i.type;if(!t.includes(o)&&u===n){var s,c;(s=window)===null||s===void 0||(c=s.im)===null||c===void 0||c.emit("toNextConv",{track_id:o})}}},Hi=function(){var t=(0,v.v9)(function(S){return S.getIn(["conversationData","conv"])}),n=(0,v.v9)(function(S){return S.getIn(["conversationData","nextCursor"])}),r=(0,v.v9)(function(S){return S.getIn(["conversationData","colleaguesHasnext"])}),a=(0,v.v9)(function(S){return S.getIn(["conversationData","hasGotMeConv"])}),i=(0,v.v9)(function(S){return S.getIn(["conversationData","hasGotCollConv"])}),o=(0,v.v9)(function(S){return S.getIn(["conversationData","hasGotAtMeConv"])}),u=(0,v.v9)(function(S){return S.getIn(["conversationData","hasGotUnrecognizedConv"])}),s=aa("robot_trusteeship"),c=(0,v.I0)(),g=(0,v.oR)().getState();function d(S){c((0,R.lT)(S))}var y=(0,h.useCallback)(function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];S.length&&c((0,R.tR)({data:S}))},[]),C=(0,h.useCallback)(function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];S.length&&c((0,R.uT)({data:S}))},[]),M=(0,h.useCallback)(function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,V={cursor:S?-1:n,limit:15,ent_id:qe},ot=window.parseInt(kt.Z.get("_agent_id")),gt=[],tt=st.kZ.CUSTOMIZED_PATH;Gi().then(function(b){var k,Y,at=b.data||[],Et=at.filter(function(x){return x.trusted!==2}),wt=at.filter(function(x){return x.trusted===2}),Tt=g.getIn(["conversationData","conv"])||[];if(S){var Lt=[];if(!Tt.length)at.forEach(function(x){var dt=x.visit_info.name;Lt.push({title:"\u65B0\u5BF9\u8BDD\uFF1A",body:"".concat(dt,"\u8FDB\u5165\u5BF9\u8BDD"),trackId:x.track_id})});else{var fn=Tt.map(function(x){return x.track_id}),re=[];at.forEach(function(x){gt.push(x.track_id),fn.includes(x.track_id)||re.push(x),Tt.forEach(function(dt){x.track_id===dt.track_id&&x.client_msg_num>dt.client_msg_num&&Lt.push({title:"\u60A8\u6709\u6D88\u606F\u672A\u56DE\u590D\uFF1A",body:x.last_msg_content,trackId:x.track_id})})}),re.length&&re.forEach(function(x){var dt=x.visit_info.name;Lt.push({title:"\u65B0\u5BF9\u8BDD\uFF1A",body:"".concat(dt,"\u8FDB\u5165\u5BF9\u8BDD"),trackId:x.track_id})})}Lt.length&&Lt.forEach(function(x,dt){setTimeout(function(){(0,E.sc)(vt(vt({},x),{},{onclick:function(){window.location.href="".concat(tt,"/chat?id=").concat(x.trackId,"&convType=mine")}}))},dt*1e3)})}c((0,R.eF)({data:Et})),(k=window)===null||k===void 0||(Y=k.im)===null||Y===void 0||Y.emit("handleTimeout",Et),c((0,R.do)({data:wt,isTrusteeship:!0})),S&&tn(gt,"mine")}).finally(function(){c((0,R.Dv)(!0))}),Ye(V).then(function(b){var k,Y;if(c((0,R.do)(vt(vt({},b),{},{reconnect:S}))),(k=window)===null||k===void 0||(Y=k.im)===null||Y===void 0||Y.emit("handleTimeout",b.data),S){var at;tn((b==null||(at=b.data)===null||at===void 0?void 0:at.map(function(Et){return Et.track_id}))||[],"coll")}}).finally(function(){c((0,R.s4)(!0))}),Ni(ot).then(function(b){if(c((0,R.L_)(b)),S){var k;tn((b==null||(k=b.data)===null||k===void 0?void 0:k.map(function(Y){return Y.track_id}))||[],"mention")}}).finally(function(){c((0,R.Of)(!0))})},[n,g]),T=(0,h.useCallback)(function(){c((0,R.Dv)(!1)),c((0,R.s4)(!1)),c((0,R.Of)(!1)),s&&c((0,R.d1)(!1)),M(!0)},[M,s]),D=(0,h.useCallback)(function(){var S={cursor:n,limit:15,ent_id:qe};return Ye(S).then(function(V){return c((0,R.do)(V)),V})},[n]),U=(0,h.useCallback)(function(){var S={cursor:-1,limit:15,ent_id:qe};return Ye(S).then(function(V){return c((0,R.do)(vt(vt({},V),{},{reconnect:!0}))),V})},[]),W=(0,h.useMemo)(function(){var S=[a,i,o];return S.every(function(V){return V})},[a,i,o,s]),I=(0,h.useMemo)(function(){var S=["clearConversations","addConvs","removeConv","updateConvMessage","updateConvVisitorName","addClientTagSocket","removeClientTagSocket","visitorCome","visitorOffline","updateConvVisitInfo","setAdvertise"];return[R.H_,R.jr,R.zf,R.mH,R.Al,R.hn,R.El,R.Sf,R.Ew,R.gF,R.rY].reduce(function(V,ot,gt){return vt(vt({},V),{},(0,p.Z)({},S[gt],function(tt){return c(ot(tt))}))},{})},[c]),B=(0,h.useCallback)(function(S){return t.find(function(V){return V.track_id===S})||Vi},[t]);return vt({conversation:t,nextCursor:n,colleaguesHasnext:r,hasGotAllConvs:W,handleGetMoreColl:D,handleGetAllConvs:M,getConversationById:B,onReconnectSocket:T,pushMeConversationList:y,pushColleaguesConversationList:C,handleColleagueToTrusteeship:d,handleGetSearchColl:U},I)};const Pr=Hi;var Os=l(209653),As=l(682772),Is=l(569600),xi=l(730381),en=l.n(xi);function Mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function It(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mr(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mr(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Se={NORMAL:0,TRUSTEESHIP:1,PRETRUSTEESHIP:2},jr={redirect:!1},Wi=en().utc("4000-01-01").valueOf(),Dr="".concat(Wi).length,nn=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=r.selectedId,i=r.markedConvIds;return(0,Ct.reverse)((0,Ct.sortBy)(t,function(o){var u=function(c,g){var d={mark:function(C){return Number(i.indexOf(C.id)!==-1)},selected:function(C){return"".concat(Number(C.id===a))},sinkDown:function(C){var M=C.client_msg_num!==0;return M?"1":"0"},onLine:function(C){var M=C.last_msg_created_on||C.last_updated,T=M?en().utc(M).valueOf():0;return"".concat(Number(C.is_client_online),"_").concat((0,E.RQ)(T,Dr))},createOn:function(C){return(0,E.RQ)(en().utc(C.created_on).valueOf(),Dr)}};return d[g](c)};return n.map(function(s){return u(o,s)}).join("_")}))},Ki=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=n.setting,a=n.stick,i=n.unRead;if(!t||t.length===0)return[];var o=r.leftConvSetting,u=o.sortMode,s=o.sinkDown;switch(u){case"conv_created_on":var c=s?["mark","sinkDown","createOn"]:["mark","createOn"];return nn(t,c,{markedConvIds:a,unRead:i});case"new_msg_first":var g=s?["mark","sinkDown","onLine"]:["mark","onLine"];return nn(t,g,{markedConvIds:a,unRead:i});default:return nn(t,["mark","createOn"],{markedConvIds:a,unRead:i})}},Fi=function(t){var n=t.conv,r=t.convStatus,a=t.replyTimeout,i=function(u){var s=r.find(function(c){return c.convId===u});return s?It(It({},jr),s):jr};return n.map(function(o){return It(It({},o),{},{status:It(It({},i(o.id)),{},{timeout:a[o.id]&&a[o.id].status==="timeout",startCountDown:a[o.id]&&a[o.id].status==="startCountDown",startTime:a[o.id]&&a[o.id].startTime||null})})})},$i=function(t,n){return(0,Ct.assign)(t,{convType:n})},Rt=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return(0,Ct.cloneDeep)(t).map(function(r){return $i(r,n)})},kr=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return t.filter(function(r){return r.agent_id===n&&r.trusted!==Se.TRUSTEESHIP&&r.trusted!==Se.PRETRUSTEESHIP})},Rr=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return t.filter(function(r){return r.trusted===Se.TRUSTEESHIP&&r.agent_id===n})},wr=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return t.filter(function(a){return r.includes(a.agent_id)&&a.agent_id!==n&&a.ended_on===null||a.trusted===Se.PRETRUSTEESHIP})},Lr=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return t.filter(function(a){return r.includes(a.agent_id)&&a.agent_id!==n&&window.parseInt(a.mentioned_agent_id)!==n&&a.ended_on===null})},Br=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return t.filter(function(r){return window.parseInt(r.mentioned_agent_id)===n&&r.agent_id!==n&&r.ended_on===null})},zi=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=n.listType,a=n.meId,i=n.agentInPermIds,o=kr(t,a),u=wr(t,a,i),s=Lr(t,a,i),c=Br(t,a),g=Rr(t,a),d=[];switch(r){case"mine":d=Rt(o,"mine");break;case"coll":d=Rt(u,"coll");break;case"mention":d=Rt(c,"mention");break;case"unrecognized":{d=Rt(g,"unrecognized");break}case"all":d=[].concat((0,rt.Z)(Rt(o,"mine")),(0,rt.Z)(Rt(s,"coll")),(0,rt.Z)(Rt(c,"mention")));break;default:d=[]}return d},Ji=function(t){return t.map(function(n){return It(It({},n),{},{visit_info:(0,E.xs)(n.visit_info)})})},rn={};function Xi(e){var t=e.convAll,n=e.im,r=e.addConvs,a=e.removeConv,i=e.updateConvMessage,o=e.updateConvVisitorName,u=e.addClientTagSocket,s=e.removeClientTagSocket,c=e.visitorCome,g=e.visitorOffline,d=e.updateConvVisitInfo,y=e.handleColleagueToTrusteeship,C=function(b){if(b&&b.length>0){var k=b.map(function(Y){return Y.body});r(k)}},M=function(b){var k=(0,Ct.get)(b,"body.conversation_body",{});k&&r([k])},T=function(b){var k=b.track_id;setTimeout(function(){a(k)})},D=function(b){typeof i=="function"&&setTimeout(function(){i(b)})},U=function(b){var k=b.body;u(k)},W=function(b){var k=b.body;s(k)},I=function(b){b&&b.length>0&&c&&c(b)},B=function(b){b&&b.length>0&&g(b)},S=function(b){D(b)},V=function(b){var k=b.conversation_id,Y=b.type,at=["message","auto_reply","promotion"];if(at.includes(Y)){var Et=t.find(function(wt){return wt.id===k});!Et&&!rn[k]&&(rn[k]=!0,n.promiseEmit("getConversation",{convId:k}).then(function(wt){var Tt=(0,Ct.get)(wt,"data",null);Tt&&r([Tt]),rn[k]=!1}))}},ot=function(b){d(b)},gt=function(b){var k=b.track_id,Y=b.body.name,at=Y;b.body.attrs&&b.body.attrs.name&&(at=Y||b.body.attrs.name),o({trackId:k,visitorName:at})};(0,h.useEffect)(function(){return n.on("getMyConversation",C),n.on("getColConversation",C),n.on("redirect",M),n.on("endConversation",T),n.on("getMyMessage",S),n.on("getColleaguesMessage",D),n.on("clientAddTag",U),n.on("clientRemoveTag",W),n.on("visitorCome",I),n.on("offline",B),n.on("updateVisitInfo",ot),n.on("agentChangeName",gt),n.on("from_colleague_to_trusteeship",y),function(){n.off("getMyConversation",C),n.off("getColConversation",C),n.off("redirect",M),n.off("endConversation",T),n.off("getMyMessage",S),n.off("getColleaguesMessage",D),n.off("clientAddTag",U),n.off("clientRemoveTag",W),n.off("visitorCome",I),n.off("offline",B),n.off("updateVisitInfo",ot),n.off("agentChangeName",gt),n.off("from_colleague_to_trusteeship",y)}},[]),(0,h.useEffect)(function(){return n.on("checkHasConversationData",V),function(){n.off("checkHasConversationData",V)}},[t])}const Yi=Xi;var qi=function(){var t=(0,v.v9)(function(n){return n.getIn(["conversationData","advertise"])});return{advertise:t}};const Zr=qi,to={useConversation:Pr,parseConversation:ut,socketEventOn:Yi,useAdvertise:Zr};var eo=function(){return(0,E.BH)({url:"/enterprise",method:"get"})},no=function(t){return(0,E.BH)({url:"/enterprise",method:"put",data:t})},ro=function(){var t=(0,v.I0)(),n=(0,v.v9)(function(o){return o.getIn(["enterprise","enterprise"])}),r=function(){var o=(0,Ee.Z)(yt().mark(function u(){var s;return yt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,eo();case 2:return s=g.sent,t(xt(s.data)),g.abrupt("return",s);case 5:case"end":return g.stop()}},u)}));return function(){return o.apply(this,arguments)}}(),a=function(u){return no(u).then(function(s){t(Wt(s.data))})},i=function(u){t(Wt(u))};return{enterprise:n,handleGetEnterprise:r,handleUpdateEnterprise:a,handleUpdateEnterpriseStore:i}};const Ur=ro;var Gr=function(t,n){var r="/agent/enterprise_config";return t&&n&&(r="".concat(r,"?source=").concat(t,"&sub_source_name=").concat(n)),r},ao=function(t,n){return(0,E.BH)({url:Gr(t,n),method:"get"})},io=function(t,n,r){return(0,E.BH)({url:Gr(n,r),method:"post",data:t})};window.getEnterpriseConfigThrotte=null;var oo={refresh:!0,throtte:!0},uo=function(t,n,r){var a=r||oo,i=a.refresh,o=i===void 0?!0:i,u=a.throtte,s=u===void 0?!0:u,c=(0,v.I0)(),g=(0,v.v9)(function(M){return M.getIn(["enterprise","enterpriseConfig"])});(0,h.useEffect)(function(){o&&d()},[t,n]);var d=function(){return window.getEnterpriseConfigThrotte&&s?window.getEnterpriseConfigThrotte:window.getEnterpriseConfigThrotte=ao(t,n).then(function(T){c(jt(T.data))}).finally(function(){window.getEnterpriseConfigThrotte=null})},y=function(T){return io(T,t,n).then(function(D){D&&D.data&&c(jt(D.data))})},C=function(T){c(jt(T))};return{enterpriseConfig:g,handleGetEnterpriseConfig:d,handleUpdateEnterpriseConfig:y,updateEnterpriseConfigStore:C}};const Nr=uo,so={useEnterprise:Ur,useEnterpriseConfig:Nr};var be=l(870885),Es=l(365069),co=function(t){return(0,E.BH)({url:"/visit/search",method:"get",params:t})},lo=function(t){var n=t.trackId,r=t.entId,a=t.type,i={track_id:n};return a&&(i.type=a),(0,E.BH)({url:"/visit/".concat(n,"/invite?ent_id=").concat(r),method:"post",data:i})},fo=function(t){return(0,E.BH)({url:"/client/".concat(t,"/pages"),method:"get"})},vo=function(t){var n=t.begin,r=t.end;return(0,E.BH)({url:"/visit/jobs",method:"POST",data:{end:r,begin:n}})};function Vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Vr(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vr(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var go=function(){var t=(0,h.useState)(!1),n=(0,be.Z)(t,2),r=n[0],a=n[1],i=(0,v.I0)(),o=(0,h.useCallback)(function(d){return fo(d).then(function(y){var C=y.data.pages;if(C)return Dt().reverse(Dt().sortBy(y.data.pages,"created_on"))})},[]),u=(0,h.useCallback)(function(d){var y=d.trackId,C="smart_guide";return lo({trackId:y,type:C,entId:kt.Z.get("_enterprise_id")}).then(function(M){return M})},[]),s=function(y){return vo(y)},c=(0,h.useMemo)(function(){var d=["visitorCome","visitorOffline","endConversation","inviteVisitor","rejectInvite","acceptInvite","changeInviteStatus","updateVisitorStatus"];return[Jt,_e,Xt,Gt,mt,Yt,me,he].reduce(function(y,C,M){return Pe(Pe({},y),{},(0,p.Z)({},d[M],function(T){return i(C(T))}))},{})},[i]),g=(0,h.useCallback)(function(d){return a(!0),co(d).then(function(y){var C;if(y!=null&&(C=y.data)!==null&&C!==void 0&&C.visits){var M=y.data.visits;i(zt(M.map(function(T){return(0,E.xs)(T)})))}}).finally(function(){a(!1)})},[]);return Pe(Pe({handleGetVisitor:g,handleGetVisitorPages:o,handleInviteVisitor:u,handleExportVisitor:s},c),{},{visitorLoading:r})};const Qr=go;var po=l(145987),_o=l(260446),mo=["value","title"];function Hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Hr(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hr(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var ho=st.Hx.allMap,an=function(t){var n=t.value,r=t.title,a=(0,po.Z)(t,mo);return Me({title:r,label:r,value:n,key:n},a)},Co={other:At.Z.t("\u5176\u4ED6"),mobile:At.Z.t("\u624B\u673A"),pc:At.Z.t("\u684C\u9762")},on=function(t,n){return t&&t[n]||n},un=function(t){var n=t.list,r=t.map,a=t.count,i=[];return Dt().forIn(n,function(o,u){var s=o.filter(function(g){return!!g}),c=on(r,u);s.length>0?i.push(Me(Me({},an({value:u,title:c,label:c,count:a[u]||0})),{},{children:s.map(function(g){return an({value:g,title:on(r,g),label:on(r,g),count:a[g]||0})})})):i.push(Me({},an({value:u,title:c,label:c,count:a[u]||0})))}),i},Vt=At.Z.t("\u56FD\u5916"),yo=["mobile","tablet"],Oo=function(t){return yo.includes(t)},Ao=["pc","bot","other"],Io=function(t){return Ao.includes(t)},xr=(0,F.P1)([function(e){return e}],function(e){var t={},n={},r={},a={},i={},o={},u=function(c,g){g[c]?g[c]+=1:g[c]=1};return e.forEach(function(s){var c=s.province,g=s.platform,d=s.os_family,y=s.country,C=s.sourceInfo;if((0,_o.I)(c)||y===At.Z.t("\u4E2D\u56FD")){var M=s.city;t[c]?t[c].includes(M)||t[c].push(M):(t[c]=[],t[c].push(M)),c!==M?(u(c,a),u(M,a)):u(c,a)}else{var T=s.country;t[Vt]?t[Vt].includes(T)||t[Vt].push(T):(t[Vt]=[],t[Vt].push(T)),u(Vt,a),u(T,a)}if(Oo(g)?(n.mobile?n.mobile.includes(d)||n.mobile.push(d):(n.mobile=[],n.mobile.push(d)),u("mobile",i),u(d,i)):Io(g)&&(n.pc?n.pc.includes(d)||n.pc.push(d):(n.pc=[],n.pc.push(d)),u("pc",i),u(d,i)),C.source){var D=C.source,U=C.subSource;r[D]?r[D].includes(U)||r[D].push(U):(r[D]=[],r[D].push(U)),D&&u(D,o),U&&u(U,o)}}),{localsHash:t,osFamilyHash:n,sourceHash:r,localsCount:a,osFamilyCount:i,sourceCount:o}}),Eo=(0,F.P1)([function(e){return xr(e)},function(e){return e}],function(e,t){var n=e.localsHash,r=e.osFamilyHash,a=e.sourceHash,i=e.localsCount,o=e.osFamilyCount,u=e.sourceCount,s=un({list:n,count:i}),c=un({list:r,map:Co,count:o}),g=un({list:a,map:ho,count:u});return s.unshift({label:At.Z.t("\u5168\u90E8"),title:At.Z.t("\u5168\u90E8"),count:t.length||0,value:"",key:""}),{region:s,device:c,source:g}}),To=(0,F.P1)([function(e){return e}],function(e){return Dt().reverse(Dt().sortBy(e,"update_on"))}),So=function(t,n){var r=!0;for(var a in n){var i=n[a];if(!Dt().isEmpty(i))switch(a){case"region":if(i!=null&&i.province){t.province!==i.province&&(r=!1);break}if(i!=null&&i.city){t.city!==i.city&&(r=!1);break}if(i!=null&&i.country){if((i==null?void 0:i.country)!=="\u56FD\u5916"){t.country!==i.country&&(r=!1);break}else if((t==null?void 0:t.country)==="\u4E2D\u56FD"){r=!1;break}}break;case"device":i.filter(function(u){return t.os_family.indexOf(u)>-1}).length===0&&(r=!1);break;case"engine":var o=i.filter(function(u){var s,c;return((s=t.sourceInfo)===null||s===void 0?void 0:s.source)===u||((c=t.sourceInfo)===null||c===void 0?void 0:c.subSource)===u}).length!==0;o||(r=!1);break;default:r=!0}}return r},bo=(0,F.P1)([function(e){return e},function(e,t){return t}],function(e,t){return e.filter(function(n){return So(n,t)})});const sn={getFilterParam:Eo,parseVisitor:To,filterVisitor:bo,getFilterCondition:xr};var Po=sn.parseVisitor,Mo=sn.getFilterParam;function jo(e){return e.filter(function(t){return!t.sourceInfo||t.sourceInfo.source!=="openCenter"})}var Do=function(){var t=(0,v.v9)(function(o){return Po(o.getIn(["visitor","visitorList"]))})||[],n=jo(t),r=(0,v.v9)(function(o){return o.getIn(["visitor","visitorCondition"])}),a=(0,v.v9)(function(o){return o.getIn(["visitor","onlineCount"])}),i=Mo(n);return{visitors:n,visitorCondition:r,filterCondition:i,onlineCount:a}};const ko=Do;function Ro(e){var t=e.im,n=e.onVisitorCome,r=e.onVisitorOffline,a=e.onEndConversation,i=e.onInviteVisitor,o=e.onRejectInvite,u=e.onAcceptInvite,s=e.changeInviteStatus,c=e.updateVisitorStatus,g=function(I){if(I&&I.length>0){var B=I.filter(function(S){var V;return S==null||(V=S.body)===null||V===void 0?void 0:V.track_id}).map(function(S){return(0,E.xs)(S.body)});B!=null&&B.length&&n(B)}},d=function(I){I&&I.length>0&&r(I)},y=function(I){var B=I==null?void 0:I.track_id;B&&setTimeout(function(){a(I)})},C=function(I){var B=I==null?void 0:I.track_id;B&&i(I)},M=function(I){var B=I==null?void 0:I.track_id;B&&o(I)},T=function(I){var B=I==null?void 0:I.track_id;B&&u(I)},D=function(I){var B=I==null?void 0:I.track_id;B&&s(I)},U=function(I){var B=I==null?void 0:I.track_id;B&&c(I)};(0,h.useEffect)(function(){return t.on("visitorCome",g),t.on("offline",d),t.on("endConversation",y),t.on("agentInvite",C),t.on("rejectInvite",M),t.on("acceptInvite",T),t.on("changeInviteStatus",D),t.on("updateVisitorStatus",U),function(){t.off("visitorCome",g),t.off("offline",d),t.off("endConversation",y),t.off("agentInvite",C),t.off("rejectInvite",M),t.off("acceptInvite",T),t.off("changeInviteStatus",D),t.off("updateVisitorStatus",U)}},[])}const wo=Ro;var Wr=l(632867);function Kr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function cn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Kr(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kr(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}window.hasRequestQueue=window.hasRequestQueue||!1,window.requestQueueLoading=window.requestQueueLoading||!1;var Lo=function(){var t=(0,h.useState)(!1),n=(0,be.Z)(t,2),r=n[0],a=n[1],i=(0,v.I0)(),o=(0,h.useCallback)(function(c){var g=c.trackId,d=c.entId;return(0,Wr.f)({trackId:g,entId:d})},[]),u=(0,h.useCallback)(function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{forceRequest:!1},g=c.forceRequest;if(window.requestQueueLoading=!0,a(!0),g||!window.hasRequestQueue&&!r)return(0,Wr.Q)().then(function(d){var y;if(d!=null&&(y=d.data)!==null&&y!==void 0&&y.queue){var C=d.data.queue;window.hasRequestQueue=!0,i(Nt(C.map(function(M){return(0,E.xs)(M)}))),i(qt(d.data.total_length))}}).finally(function(){window.requestQueueLoading=!1,a(!1)})},[]),s=(0,h.useMemo)(function(){var c=["addQueue","removeQueue","queueOffline","queueOnline"];return[Ce,ye,f,O].reduce(function(g,d,y){return cn(cn({},g),{},(0,p.Z)({},c[y],function(C){return i(d(C))}))},{})},[i]);return cn({handleGetQueue:u,handleInviteQueue:o,loading:r},s)};const Fr=Lo;var Bo=function(){var t=(0,v.v9)(function(r){return r.getIn(["visitor","queueList"])}),n=(0,v.v9)(function(r){return r.getIn(["visitor","queueInline"])});return{queue:t,queueInline:n}};const Zo=Bo;function $r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function zr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$r(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$r(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Uo(e){var t=e.im,n=e.onQueueAdd,r=e.onQueueRemove,a=e.onQueueOffline,i=e.onQueueOnline,o=function(d){var y={status:!0};n((0,E.xs)(zr(zr({},d.body),y)))},u=function(d){var y;d!=null&&(y=d.body)!==null&&y!==void 0&&y.track_ids&&r(d.body.track_ids)},s=function(d){setTimeout(function(){d&&d.length>0&&a(d)})},c=function(d){d&&d.length>0&&i(d)};(0,h.useEffect)(function(){return t.on("queueAdd",o),t.on("queueRemove",u),t.on("offline",s),t.on("online",c),function(){t.off("queueAdd",o),t.off("queueRemove",u),t.off("offline",s),t.off("online",c)}},[])}const Go={useVisitor:Qr,useVisitorData:ko,socketEventOn:wo,parseVisitor:sn,useQueue:Fr,useQueueData:Zo,socketEventOnQueue:Uo};function Jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ln(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Jr(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jr(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var No=function(t){var n=t.entId;return new Promise(function(r,a){(0,E.BH)({url:"/conversation/tags",method:"get",params:{ent_id:n}}).then(function(i){var o=i.data;r(ln({},o))}).catch(function(i){a(i)})})},Vo=function(t){return(0,E.BH)({url:"/conversation/tags/".concat(t),method:"delete"})},Qo=function(t){var n=t.color,r=t.level,a=t.parentId,i=t.parent_id,o=t.tag_name,u=t.tagName;return(0,E.BH)({url:"/conversation/tags",method:"post",data:{color:n,level:r,parent_id:window.parseInt(i!=null?i:a),tag_name:o||u}})},Ho=function(t){var n=t.color,r=t.level,a=t.parentId,i=t.tagName,o=t.id,u=t.parent_id,s=t.tag_name;return(0,E.BH)({url:"/conversation/tags/".concat(o),method:"put",data:{color:n,level:r,parent_id:window.parseInt(a||u),tag_name:i||s}})},xo=function(t){return t.map(function(n){return ln(ln({},n),{},{label:n.name,value:n.id})})},Wo=function(){return(0,E.BH)({url:"/agent/client_tags",method:"get"}).then(function(t){if(t&&t.data&&t.data.client_tags){var n=xo(t.data.client_tags);return n.sort(function(r,a){return r.rank-a.rank})}return[]})},Ko=function(t){return(0,E.BH)({url:"/agent/client_tags",method:"POST",data:t})},Fo=function(t,n){return(0,E.BH)({url:"/agent/client_tags/".concat(t),method:"PUT",data:n})},$o=function(t){return(0,E.BH)({url:"/agent/client_tags/".concat(t),method:"DELETE"})};function Xr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Xr(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xr(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var zo=[],Yr=(0,F.P1)([function(e){return e}],function(e){if((e==null?void 0:e.length)===0)return zo;var t=function(a,i){var o=e.findIndex(function(u){return u.id===a});e[o].color=i},n=function(a,i){var o=e.findIndex(function(u){return u.id===a});e[o].order=i};return e.filter(function(r){return r.level===1}).forEach(function(r){n(r.id,(0,E.RQ)(r.id,8))}),[2,3,4].forEach(function(r){var a=e.filter(function(o){return o.level===r}),i=e.filter(function(o){return o.level===r-1});a.forEach(function(o){var u=i.find(function(s){return s.id===o.parent_id});u&&(t(o.id,u.color),n(o.id,"".concat(u.order,"_").concat((0,E.RQ)(o.id,6))))})}),e.sort(function(r,a){return r.id-a.id}),e}),Jo=(0,F.P1)([function(e){return Yr(e)}],function(e){return e.map(function(t){return ne(ne({},t),{},{label:t.tag_name,value:t.id})})}),Xo=(0,F.P1)([function(e){return e},function(e,t){return t}],function(e,t){if(e&&e.length){var n=[];return e.forEach(function(r){var a=Dt().find(t,["id",r]);a&&n.push(a)}),n}return[]}),Yo=(0,F.P1)([function(e){return e}],function(e){var t={};function n(a,i,o,u,s){var c=[],g=a.filter(function(d){return d.level===i&&(o?d.parent_id===o:!0)});return g.length>0&&(c=g.map(function(d){var y=ne(ne({},d),{},{name:d.tag_name,key:d.id,value:d.id,active:!1,label:d.tag_name,title:d.tag_name,fullName:s?"".concat(s.fullName,"/").concat(d.tag_name):d.tag_name}),C=n(a,i+1,d.id,u||d.color,y);return u&&(y.color=u),t[d.id]=ne({},y),C.length>0&&(y.children=C),y.cls="".concat(y.color," tag"),y})),c}var r=n(e,1);return{convTagMap:t,convTagTree:r}});const Qt={getConvTag:Xo,buildChildConvTag:Yr,parseConvTag:Jo,getConvTagTreeList:Yo};var qo=Qt.parseConvTag,tu=Qt.getConvTag,eu=Qt.getConvTagTreeList,nu=window.parseInt(kt.Z.get("_enterprise_id")),ru=function(t){var n=t||{},r=n.refresh,a=r===void 0?!0:r,i=(0,v.v9)(function(C){return C.getIn(["tag","convTag"])}),o=qo(i),u=eu(i),s=u.convTagMap,c=u.convTagTree,g=(0,v.I0)(),d=(0,h.useCallback)(function(){return No({entId:nu}).then(function(C){return g($(C)),C})},[]),y=(0,h.useCallback)(function(C){return tu(C,o)},[o]);return(0,h.useEffect)(function(){a&&d()},[a]),{convTag:o,convTagSetting:i,convTagMap:s,convTagTree:c,handleGetConvTag:d,handleGetConvTagById:y,updateConversationTagApi:Ho,deleteConversationTagApi:Vo,createConversationTagApi:Qo}};const qr=ru;var au=window.parseInt(kt.Z.get("_enterprise_id"));window.getCustomerTagThrotte=null;var iu=function(t){var n=t||{},r=n.refresh,a=r===void 0?!0:r,i=n.throtte,o=i===void 0?!0:i,u=(0,h.useState)(!1),s=(0,be.Z)(u,2),c=s[0],g=s[1],d=(0,v.v9)(function(M){return M.getIn(["tag","customerTag"])}),y=(0,v.I0)(),C=(0,h.useCallback)(function(){return window.getCustomerTagThrotte&&o?window.getCustomerTagThrotte:(g(!0),window.getCustomerTagThrotte=Wo({entId:au}).then(function(M){return y(it(M)),M}).finally(function(){g(!1),window.getCustomerTagThrotte=null}))},[]);return(0,h.useEffect)(function(){a&&C()},[a]),{customerTagSetting:d,handleGetCustomerTag:C,addCustomerTagApi:Ko,removeCustomerTagApi:$o,updateCustomerTagApi:Fo,loading:c}};const ta=iu;var ou=function(){return(0,E.BH)({url:"/unified-api/call/v1/tag",method:"GET"})},uu=function(t){return(0,E.BH)({url:"/unified-api/call/v1/tag",method:"POST",data:t})},su=function(t){return(0,E.BH)({url:"/unified-api/call/v1/tag/"+t,method:"DELETE"})},cu=function(t,n){return(0,E.BH)({url:"/unified-api/call/v1/tag/"+t,method:"PUT",data:n})},lu=function(t){return(0,E.BH)({url:"/unified-api/call/v1/record/unbind/tag",method:"post",data:t})},du=function(t){return(0,E.BH)({url:"/unified-api/call/v1/record/bind/tag",method:"post",data:t})},fu=Qt.parseConvTag,vu=Qt.getConvTag,gu=Qt.getConvTagTreeList,pu=window.parseInt(kt.Z.get("_enterprise_id")),_u=function(t){var n=t||{},r=n.refresh,a=r===void 0?!0:r,i=(0,v.v9)(function(C){return C.getIn(["tag","callTag"])}),o=fu(i),u=gu(i),s=u.convTagMap,c=u.convTagTree,g=(0,v.I0)(),d=(0,h.useCallback)(function(){return ou({entId:pu}).then(function(C){return g(ht(C==null?void 0:C.data)),C})},[]),y=(0,h.useCallback)(function(C){return vu(C,o)},[o]);return(0,h.useEffect)(function(){a&&d()},[a]),{callTag:o,callTagSetting:i,callTagMap:s,callTagTree:c,handleGetCallTag:d,handleGetCallTagById:y,updateCallTagApi:cu,deleteCallTagApi:su,addCallTagApi:uu,bindCallTagApi:du,unbindCallTagApi:lu}};const mu={useConvTag:qr,useCustomerTag:ta,useCallTag:_u};var hu=function(){var t=(0,v.I0)(),n=(0,v.v9)(function(_){return _.getIn(["call","toolBarShowInfo"])}),r=(0,v.v9)(function(_){return _.getIn(["call","callingClient"])}),a=(0,v.v9)(function(_){return _.getIn(["call","sipNumber"])}),i=(0,v.v9)(function(_){return _.getIn(["call","callAgentStatus"])}),o=(0,v.v9)(function(_){return _.getIn(["call","sipMessage"])}),u=(0,v.v9)(function(_){return _.getIn(["call","connecting"])}),s=(0,v.v9)(function(_){return _.getIn(["call","inCall"])}),c=(0,v.v9)(function(_){return _.getIn(["call","registerData"])}),g=(0,v.v9)(function(_){return _.getIn(["call","allowCall"])}),d=(0,v.v9)(function(_){return _.getIn(["call","janusErrorMessage"])}),y=(0,v.v9)(function(_){return _.getIn(["call","summaryConfig"])}),C=(0,v.v9)(function(_){return _.getIn(["call","answerType"])}),M=(0,v.v9)(function(_){return _.getIn(["call","mobileNumber"])}),T=(0,v.v9)(function(_){return _.getIn(["call","softSwitchMessage"])}),D=(0,v.v9)(function(_){return _.getIn(["call","softSwitchApplicationRegistered"])}),U=(0,v.v9)(function(_){return _.getIn(["call","jssipMessage"])}),W=(0,v.v9)(function(_){return _.getIn(["call","uuid"])}),I=(0,v.v9)(function(_){return _.getIn(["call","activeAgentStatus"])}),B=(0,v.v9)(function(_){return _.getIn(["call","sipRegistered"])}),S=(0,v.v9)(function(_){return _.getIn(["call","currentCallInfo"])}),V=(0,v.v9)(function(_){return _.getIn(["call","fakeRecord"])}),ot=(0,v.v9)(function(_){return _.getIn(["call","selectedClient"])}),gt=(0,h.useCallback)(function(_){t(En({client:_}))},[]),tt=(0,h.useCallback)(function(_){t(Tn({sipNumber:_}))},[]),b=(0,h.useCallback)(function(_){t(Sn({status:_}))},[]),k=(0,h.useCallback)(function(_){t(bn({message:_}))},[]),Y=(0,h.useCallback)(function(_){t(Pn({connecting:_}))},[]),at=(0,h.useCallback)(function(_){t(Mn({inCall:_}))},[]),Et=(0,h.useCallback)(function(_){t(Dn({data:_}))},[]),wt=(0,h.useCallback)(function(_){t(jn({value:_}))},[]),Tt=(0,h.useCallback)(function(_){t(kn({obj:_}))},[]),Lt=(0,h.useCallback)(function(_){t(Rn({config:_}))},[]),fn=(0,h.useCallback)(function(_){t(wn({type:_}))},[]),re=(0,h.useCallback)(function(_){t(Ln({number:_}))},[]),x=(0,h.useCallback)(function(_){t(Bn({message:_}))}),dt=(0,h.useCallback)(function(_){t(Zn({registered:_}))}),va=(0,h.useCallback)(function(_){t(Un({message:_}))},[]),ts=(0,h.useCallback)(function(_){t(Gn({uuid:_}))},[]),es=(0,h.useCallback)(function(_){t(Nn({data:_}))},[]),ns=(0,h.useCallback)(function(_){t(Vn({data:_}))},[]),rs=(0,h.useCallback)(function(_){t(Qn({data:_}))},[]),as=(0,h.useCallback)(function(_){t(Hn({data:_}))},[]),is=(0,h.useCallback)(function(_){t(In({data:_}))},[]),os=(0,h.useCallback)(function(_){t(xn({data:_}))},[]);return{callUUID:W,inCall:s,sipNumber:a,allowCall:g,sipMessage:o,connecting:u,answerType:C,mobileNumber:M,registerData:c,callingClient:r,summaryConfig:y,callAgentStatus:i,janusErrorMessage:d,softSwitchMessage:T,softSwitchApplicationRegistered:D,toolBarShowInfo:n,activeAgentStatus:I,sipRegistered:B,jssipMessage:U,currentCallInfo:S,fakeRecord:V,selectedClient:ot,updateFakeRecord:is,updateCurrentCallInfo:as,updateSipNumber:tt,updateInCall:at,updateAllowCall:wt,updateSipMessage:k,updateAnswerType:fn,updateConnecting:Y,updateMobileNumber:re,updateRegisterData:Et,updateCallingClient:gt,updateSummaryConfig:Lt,updateCallAgentStatus:b,updateJanusErrorMessage:Tt,updateSoftSwitchMessage:x,updateSoftSwitchApplicationRegistered:dt,updateJssipMessage:va,updateUUid:ts,updateToolBarShowInfo:es,updateActiveAgentStatus:ns,updateSipRegistered:rs,updateSelectedClient:os}};const Cu={useCallStore:hu};var yu=function(){return(0,E.BH)({url:"/enterprise/iframes",method:"get"})},Ou=function(){return(0,E.BH)({url:"/unified-api/team/v1/enterprise/iframe_encrypt_config",method:"get"})},Au=function(t){return(0,E.BH)({url:"/unified-api/team/v1/enterprise/iframe_encrypt_config/enabled",method:"put",data:{enable:t}})},Iu=function(t){return(0,E.BH)({url:"/unified-api/team/v1/enterprise/iframes/encrypt",method:"post",params:{value:t}})},Eu=function(){var t=(0,v.I0)(),n=(0,v.v9)(function(u){return u.getIn(["iframePlugin","data"])}),r=(0,v.v9)(function(u){return u.getIn(["iframePlugin","encryptConfigData"])}),a=function(){yu().then(function(s){t(Fn(s.data))})},i=function(){Ou().then(function(s){t(He(s.data))})},o=function(s){return Au(s).then(function(c){c&&c.data&&t(He(c.data))})};return{iframePlugin:n,iframeEncryptConfig:r,handleGetIframePlugin:a,handleGetIframeEncryptConfig:i,handleChangeIframeEncryptConfig:o}};const ea=Eu;var Tu=function(t){var n=t.info,r=(0,h.useState)(""),a=(0,be.Z)(r,2),i=a[0],o=a[1],u=function(){o(""),Iu(n).then(function(c){c&&c.data&&o(c.data)})};return(0,h.useEffect)(function(){u()},[n]),{encryptInfo:i}};const Su={useIframePlugin:ea,useIframeEncrypt:Tu};var bu=function(t){return(0,E.BH)({url:"/custom_msg/product_card_info",method:"get",params:{ent_id:t}})},Pu=function(){var t=(0,v.I0)(),n=(0,v.v9)(function(i){return i.getIn(["productCard","data"])}),r=(0,h.useMemo)(function(){var i={};return Array.isArray(n)&&n.forEach(function(o){o&&o.product_url&&(i[o.product_url]=o)}),i},[n]),a=function(o){bu(o).then(function(u){t(Wn(u.data))})};return{productCard:n,productCardMap:r,handleGetProductCard:a}};const na=Pu,Mu={useProductCard:na};var ju=l(239714),Du=function(){var t=(0,ju.Z)({key:"conv_setting"}),n=t.getFeConfig,r=t.updateFeConfig,a=(0,v.v9)(function(s){return s.getIn(["convSetting"])}),i=(0,v.I0)(),o=(0,h.useCallback)(function(s){var c=JSON.stringify(s);return r(c).then(function(g){return g!=null&&g.data&&i(xe(s)),g})},[]),u=(0,h.useCallback)(function(){return n().then(function(s){var c;if(s!=null&&(c=s.data)!==null&&c!==void 0&&c.conv_setting){var g=JSON.parse(s.data.conv_setting);i(xe(g))}})},[]);return{convSetting:a,handleGetConvSetting:u,handleUpdateConvSetting:o}};const ra=Du,ku={useConvSetting:ra};var Ps=l(605212);function Ru(e){var t=(0,v.v9)(function(i){return i.get("func")}),n=(0,h.useMemo)(function(){return{functionMap:t.get("functionMap"),permReady:t.get("permReady")}},[t]),r=n.functionMap,a=n.permReady;return Array.isArray(e)?e.some(function(i){return a?!!r[i]:!1}):a?!!r[e]:!1}const aa=Ru;function wu(e){var t=(0,v.v9)(function(i){return i.get("func")}),n=(0,h.useMemo)(function(){return{permMap:t.get("permMap"),permReady:t.get("permReady")}},[t]),r=n.permMap,a=n.permReady;return e==="special_perm"?!0:!e||!a?!1:Array.isArray(e)?e.every(function(i){return a?!!r[i]:!1}):a?!!r[e]:!1}const Lu=wu;var Bu=function(){return(0,E.BH)({url:"/enterprise/functions",method:"get"})};function Zu(){var e=(0,v.I0)(),t=(0,v.v9)(function(c){return c.get("func")}),n=(0,h.useMemo)(function(){return{functionMap:t.get("functionMap"),permMap:t.get("permMap"),permReady:t.get("permReady"),functions:t.get("functions"),perms:t.get("perms")}},[t]),r=n.functionMap,a=n.permReady,i=n.permMap,o=n.functions,u=n.perms,s=(0,h.useCallback)(function(){Bu().then(function(c){e(tr(c))})},[]);return{initFunction:s,functionMap:r,permReady:a,permMap:i,functions:o,perms:u}}const Uu=Zu;var Gu=st.pg.NOTIFICATION_BASE_URL,Nu=function(){return(0,E.BH)({baseURL:Gu,url:"/notify/unread_num",method:"post",deleteEntid:!0,data:{}})},Vu=function(){var t=(0,v.I0)(),n=(0,v.v9)(function(i){return i.getIn(["notification","count"])}),r=(0,h.useCallback)(function(){Nu().then(function(i){return t(Fe({count:i.data.data}))})},[]),a=(0,h.useCallback)(function(i){t(Fe({count:i}))},[]);return{newNotificationCount:n,refreshNotificationCount:r,setNotificationCount:a}};const ia=Vu,Ms={useNotificationCount:ia};var Qu=function(){var t=(0,v.v9)(function(n){return n.getIn(["translate","translateData"])});return{translateData:t}};const oa=Qu;function ua(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function dn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ua(Object(n),!0).forEach(function(r){(0,p.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ua(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Hu=function(){var t=(0,v.I0)(),n=(0,h.useMemo)(function(){var r=["addTranslateData","removeTranslateData"];return[rr,ar].reduce(function(a,i,o){return dn(dn({},a),{},(0,p.Z)({},r[o],function(u){return t(i(u))}))},{})},[t]);return dn({},n)};const sa=Hu;function xu(e){var t=e.im,n=e.removeTranslateData,r=function(i){var o=i.track_id;n(o)};(0,h.useEffect)(function(){return t.on("endConversation",r),function(){t.off("endConversation",r)}},[])}const ca=xu;var Wu=function(){return(0,E.BH)({url:"/unified-api/conversations/v1/conversation/translate/config",method:"get"})},Ku=function(){var t=(0,v.I0)(),n=(0,v.v9)(function(a){return a.getIn(["translate","translateQuota"])}),r=function(){return new Promise(function(i,o){Wu().then(function(u){u.data?(t(ir(u.data)),i(u.data)):o()}).catch(function(){o()})})};return{translateQuota:n,getTranslationQuotaInfo:r}};const la=Ku,js={useTranslateData:oa,useTranslate:sa,useSocketEventOnTranslate:ca,useTranslateQuota:la};function Fu(){var e=(0,v.I0)(),t=(0,v.v9)(function(i){return i.get("func")}),n=(0,h.useMemo)(function(){return{livechatPermMap:t.get("livechatPermMap")}},[t]),r=n.livechatPermMap,a=(0,h.useCallback)(function(i){e(er(i))},[]);return{livechatPermMap:r,updateLivechatPerm:a}}const $u=Fu;var zu=function(){return(0,E.BH)({baseURL:st.pg.runEnv==="PROD"?"https://api-gateway.meiqia.com":"https://api-gateway-qa-int.meiqia.com",url:"/omni/opendock/source/sources",method:"get"})},da=function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=[];return t.forEach(function(a){var i={},o=a.sub_source,u=a.name,s=a.display_name;o&&o.length&&(i.children=e(o,a)),i.value=n?"".concat(n.name,".").concat(u):u,i.label=s||u,r.push(i)}),(n==null?void 0:n.name)==="web"&&r.push({label:"\u9ED8\u8BA4\u63A5\u5165\u6E20\u9053",value:"web.default"}),r},Ju=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=[];return t.forEach(function(a){var i={},o=a.sub_source,u=a.name,s=a.display_name;o&&o.length&&r.push.apply(r,(0,rt.Z)(da(o,a))),i.label=s||u,i.value=n?"".concat(n.name,".").concat(u):u,r.push(i)}),r},Xu=(0,F.P1)([function(e){return e}],function(e){return da(e)}),Yu=(0,F.P1)([function(e){return e}],function(e){return[].concat((0,rt.Z)(Ju(e)),[{label:"\u9ED8\u8BA4\u63A5\u5165\u6E20\u9053",value:"web.default"}])}),qu=function(){var t=(0,v.I0)(),n=(0,v.v9)(function(o){return o.getIn(["channel","channelList"])}),r=(0,v.v9)(function(o){return Xu(o.getIn(["channel","channelList"]))}),a=(0,v.v9)(function(o){return Yu(o.getIn(["channel","channelList"]))}),i=(0,h.useCallback)((0,Ee.Z)(yt().mark(function o(){var u,s,c;return yt().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,zu();case 2:s=d.sent,c=(s==null||(u=s.data)===null||u===void 0?void 0:u.source)||[],t(nr({data:c}));case 5:case"end":return d.stop()}},o)})),[]);return{channelList:n,channelTree:r,flatChannel:a,getChannelList:i}};const fa=qu,Ds={useChannel:fa}},866681:(je,St,l)=>{l.d(St,{I0:()=>ft,ZP:()=>De,oR:()=>Bt,v9:()=>Zt});var ut=l(667294),v=l(649226),ct=ut.createContext(null),Bt=(0,v.fw)(ct),ft=(0,v.AS)(ct),Zt=(0,v.gR)(ct),p=function(ae){var X=ae.children,q=ae.store;return ut.createElement(v.zt,{context:ct,store:q},X)};const De=p},590658:(je,St,l)=>{l.d(St,{Al:()=>fe,Dv:()=>z,El:()=>$t,Ew:()=>pe,H_:()=>le,L_:()=>st,Of:()=>G,Sf:()=>ge,ZP:()=>ye,cL:()=>zt,d1:()=>ce,do:()=>Ue,eF:()=>Ze,gF:()=>J,hn:()=>ve,jr:()=>Ft,lT:()=>Qe,mH:()=>_t,rY:()=>Jt,s4:()=>Kt,tR:()=>Ge,uT:()=>Ne,zf:()=>de});var ut=l(447941),v=l.n(ut),ct=l(382526),Bt=l.n(ct),ft=l(438880),Zt=l.n(ft),p=l(489554),De=l.n(p),ke=l(454747),ae=l.n(ke),X=l(749337),q=l.n(X),nt=l(833321),pt=l.n(nt),bt=l(369070),ie=l.n(bt),lt=l(242982),w=l(204942),oe=l(821249),Re=l.n(oe),we=l(185827),vn=l.n(we),Le=l(241539),gn=l.n(Le),Pt=l(34553),pn=l.n(Pt),Be=l(57327),_n=l.n(Be),R=l(891058),ga=l.n(R),mn=l(279753),pa=l.n(mn),hn=l(892222),_a=l.n(hn),Cn=l(969826),ma=l.n(Cn),yn=l(140561),ha=l.n(yn),Mt=l(596882),ue=l(567178),Ut=l(135369),Ht=l(496486),xt=l.n(Ht),Wt=l(131955),jt=l(954896),Z;function se(f,O){var m=Object.keys(f);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(f);O&&(A=A.filter(function(P){return Object.getOwnPropertyDescriptor(f,P).enumerable})),m.push.apply(m,A)}return m}function L(f){for(var O=1;O<arguments.length;O++){var m=arguments[O]!=null?arguments[O]:{};O%2?se(Object(m),!0).forEach(function(A){(0,w.Z)(f,A,m[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(m)):se(Object(m)).forEach(function(A){Object.defineProperty(f,A,Object.getOwnPropertyDescriptor(m,A))})}return f}var rt=function(O){return O.map(function(m){return L(L({},m),{},{visit_info:(0,jt.xs)(m.visit_info)})})},On=function(O){return O.reduce(function(m,A){return L(L({},m),{},(0,w.Z)({},A,function(P){return P}))},{})},Q=(0,Mt.Z)(L({},On(["setMeConversations","forcePushMeConversations","forcePushColleaguesConversations","setColleaguesConversations","setAtMeConversations","setHasGotMeConv","setHasGotUnrecognizedConv","setUnrecognizedConv","setHasGotCollConv","setHasGotAtMeConv","clearConversations","addConvs","removeConv","updateConvMessage","updateConvVisitorName","addClientTagSocket","removeClientTagSocket","visitorCome","visitorOffline","updateConvVisitInfo","moveConversationFromColleagueToTrusteeship","moveConversationFromTrusteeshipToMine","setAdvertise"]))),Ze=Q.setMeConversations,Ue=Q.setColleaguesConversations,Ge=Q.forcePushMeConversations,Ne=Q.forcePushColleaguesConversations,st=Q.setAtMeConversations,z=Q.setHasGotMeConv,Kt=Q.setHasGotCollConv,G=Q.setHasGotAtMeConv,Ve=Q.setUnrecognizedConv,ce=Q.setHasGotUnrecognizedConv,le=Q.clearConversations,Ft=Q.addConvs,de=Q.removeConv,_t=Q.updateConvMessage,fe=Q.updateConvVisitorName,ve=Q.addClientTagSocket,$t=Q.removeClientTagSocket,ge=Q.visitorCome,pe=Q.visitorOffline,J=Q.updateConvVisitInfo,Qe=Q.moveConversationFromColleagueToTrusteeship,zt=Q.moveConversationFromTrusteeshipToMine,Jt=Q.setAdvertise,_e=(0,Ut.Map)({conv:[],colleaguesHasnext:!1,nextCursor:-1,hasGotMeConv:!1,hasGotCollConv:!1,hasGotAtMeConv:!1,setHasGotUnrecognizedConv:!1,advertise:{}}),Xt=function(O){return O.reduce(function(m,A){var P=m.findIndex(function(N){return N.track_id===A.track_id});if(P>=0){var j=m[P];A.last_updated>=m[P].last_updated?m[P]=L(L({},j),A):m[P]=L(L({},A),j)}else m.push(A);return m},[])};function Gt(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],O=arguments.length>1?arguments[1]:void 0,m=Wt.Z.get("_agent_id");if(!(f!=null&&f.length))return f;switch(O){case"me":return f.filter(function(A){return A.agent_id!==+m});case"colleagues":return f.filter(function(A){return A.agent_id===+m||window.parseInt(A.mentioned_agent_id)===+m});case"@me":return f.filter(function(A){return window.parseInt(A.mentioned_agent_id)!==+m});default:return f}}function mt(f,O){var m=O.filter(function(P){return!P.ended_on});if(Array.isArray(f)&&Array.isArray(m)&&m.length){var A=rt(m);return Xt([].concat((0,lt.Z)(f),(0,lt.Z)(A)))}return f}function Yt(f,O){if(Array.isArray(f)&&Array.isArray(O)&&O.length){var m=rt(O);return Xt([].concat((0,lt.Z)(f),(0,lt.Z)(m)))}return f}function me(f,O){var m=O.created_on,A=O.from_type,P=O.type,j={};return A==="client"&&(j.client_msg_num=f?(f.client_msg_num||0)+1:1,P==="message"&&(j.agent_effective_msg_num+=1)),L(L({},f),{},{last_msg_created_on:m,last_msg_content:(0,jt.OD)(O)},j)}function he(f,O){var m=xt().sortBy(O,function(A){return A.created_on});return m.reduce(function(A,P){var j=P.track_id,N=f.find(function(ht){return ht.track_id===j}),$=f.findIndex(function(ht){return ht.track_id===j}),it=A;return it[$]=me(N,P),it},f)}function Nt(f,O,m){return f.update("conv",function(A){return A.map(function(P){var j=P,N=P.track_id;return N===O&&(j=L(L({},j),m)),j})})}function qt(f,O,m){return f.update("conv",function(A){return A.map(function(P){var j=P,N=P.track_id,$=O.find(function(it){return it.track_id===N});return $&&(j=L(L({},j),m)),j})})}var Ce=(0,ue.Z)((Z={},(0,w.Z)(Z,Ze,function(f,O){var m=Gt(f.get("conv"),"me");return f.set("conv",mt(m,O.payload.data))}),(0,w.Z)(Z,Ge,function(f,O){return f.set("conv",Yt(f.get("conv"),O.payload.data))}),(0,w.Z)(Z,Ne,function(f,O){var m=O.payload.data;return f.set("conv",Yt(f.get("conv"),m))}),(0,w.Z)(Z,Ue,function(f,O){var m=O.payload,A=m.hasNext,P=m.data,j=m.nextCursor,N=m.reconnect,$=m.isTrusteeship,it=!N||$?f.get("conv"):Gt(f.get("conv"),"colleagues");return $?f.set("conv",mt(it,P)):f.set("conv",mt(it,P)).set("colleaguesHasnext",A).set("nextCursor",j)}),(0,w.Z)(Z,st,function(f,O){var m=Gt(f.get("conv"),"@me");return f.set("conv",mt(m,O.payload.data))}),(0,w.Z)(Z,z,function(f,O){return f.set("hasGotMeConv",O.payload)}),(0,w.Z)(Z,Kt,function(f,O){return f.set("hasGotCollConv",O.payload)}),(0,w.Z)(Z,G,function(f,O){return f.set("hasGotAtMeConv",O.payload)}),(0,w.Z)(Z,ce,function(f,O){return f.set("hasGotUnrecognizedConv",O.payload)}),(0,w.Z)(Z,le,function(f){return f.set("conv",[])}),(0,w.Z)(Z,Ft,function(f,O){return f.set("conv",mt(f.get("conv"),O.payload))}),(0,w.Z)(Z,de,function(f,O){return f.update("conv",function(m){return m.length&&O.payload?m.filter(function(A){var P=A.track_id;return P!==O.payload}):m})}),(0,w.Z)(Z,_t,function(f,O){var m=xt().clone(f.get("conv")),A=he(m,O.payload);return f.set("conv",A)}),(0,w.Z)(Z,fe,function(f,O){var m=O.payload,A=m.trackId,P=m.visitorName;return f.update("conv",function(j){return j.map(function(N){var $=N,it=N.track_id,ht=N.visit_info;return it===A&&($=L(L({},$),{visit_info:L(L({},ht),{name:P})})),$})})}),(0,w.Z)(Z,ve,function(f,O){var m=O.payload,A=m.track_id,P=m.tag_id,j=f.get("conv").find(function($){return $.track_id===A}),N=j&&j.tags||[];return Nt(f,A,{tags:[].concat((0,lt.Z)(N),[P])})}),(0,w.Z)(Z,$t,function(f,O){var m=O.payload,A=m.track_id,P=m.tag_id,j=f.get("conv").find(function($){return $.track_id===A}),N=j&&j.tags||[];return Nt(f,A,{tags:N.filter(function($){return $!==P})})}),(0,w.Z)(Z,ge,function(f,O){return qt(f,O.payload,{is_client_online:!0})}),(0,w.Z)(Z,pe,function(f,O){return qt(f,O.payload,{is_client_online:!1})}),(0,w.Z)(Z,J,function(f,O){var m=O.payload,A=m.track_id,P=m.visit_info,j=P===void 0?{}:P,N=f.get("conv").find(function(it){return it.track_id===A});if(N&&N.visit_info){var $=L(L({},N.visit_info),j);return Nt(f,A,{visit_info:$})}return f}),(0,w.Z)(Z,Qe,function(f,O){return f.update("conv",function(m){var A=m.findIndex(function(j){return j.id===O.payload.conv_id});if(A>-1){var P=L(L({},m[A]),{},{trusted:1});return m.splice(A,1,P),(0,lt.Z)(m)}return m})}),(0,w.Z)(Z,zt,function(f,O){return f.update("conv",function(m){var A=m.findIndex(function(j){return j.id===O.payload.conv_id});if(A>-1){var P=L(L({},m[A]),{},{trusted:0});return m.splice(A,1,P),(0,lt.Z)(m)}return m})}),(0,w.Z)(Z,Jt,function(f,O){return f.set("advertise",O.payload||{})}),Z),_e);const ye=Ce},632867:(je,St,l)=>{l.d(St,{Q:()=>v,f:()=>ct});var ut=l(954896),v=function(){return(0,ut.BH)({url:"/agent/queue",method:"get"})},ct=function(ft){var Zt=ft.trackId;return(0,ut.BH)({url:"/conversation/new",method:"post",data:{track_id:Zt}})}}}]);

//#